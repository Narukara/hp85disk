\hypertarget{td02lif_8c}{}\doxysection{lif/td02lif.c File Reference}
\label{td02lif_8c}\index{lif/td02lif.c@{lif/td02lif.c}}


Tele\+Disk decoder library targetting L\+IF format images only.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$inttypes.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lifsup.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lifutils.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}td02lif.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}td0\+\_\+lzss.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{td02lif_8c_a369d6a9b15ee337cfb9e998b3e914f9c}{td0\+\_\+\+B2S}} (uint8\+\_\+t $\ast$B, int index, uint8\+\_\+t $\ast$name, int size)
\begin{DoxyCompactList}\small\item\em Create a string from data that has no E\+OS but known size. \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{td02lif_8c_a1e9e20346b224655b6586eb34efe1b5f}{td0\+\_\+crc16}} (uint8\+\_\+t $\ast$B, uint16\+\_\+t crc, uint16\+\_\+t poly, int size)
\begin{DoxyCompactList}\small\item\em Compute C\+R\+C16 of 8bit data. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{td02lif_8c_a4d01fdafef7fb089054149fd0c04c75f}{td0\+\_\+hexdump}} (uint8\+\_\+t $\ast$data, int size)
\begin{DoxyCompactList}\small\item\em hex listing of data \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a038d4e9f86f76569a97e443e376a8e11}{td0\+\_\+unpack\+\_\+disk\+\_\+header}} (uint8\+\_\+t $\ast$B, \mbox{\hyperlink{structtd__header__t}{td\+\_\+header\+\_\+t}} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk image header data in architecture nutral way. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_aa2721b8d8bba4008a2b48d1b362b9850}{td0\+\_\+unpack\+\_\+comment\+\_\+header}} (uint8\+\_\+t $\ast$B, \mbox{\hyperlink{structtd__comment__t}{td\+\_\+comment\+\_\+t}} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk comment header data in architecture nutral way. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_ab9cc29346498d37ff85d3a3417d8fc11}{td0\+\_\+unpack\+\_\+track\+\_\+header}} (uint8\+\_\+t $\ast$B, \mbox{\hyperlink{structtd__track__t}{td\+\_\+track\+\_\+t}} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk track header data in architecture nutral way. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_ac393151af482d511b246de534da58e6f}{td0\+\_\+unpack\+\_\+sector\+\_\+header}} (uint8\+\_\+t $\ast$B, \mbox{\hyperlink{structtd__sector__t}{td\+\_\+sector\+\_\+t}} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk sector header data in architecture nutral way. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{td02lif_8c_a786b280e1ac85ba19bcb2f4ca0d21ee3}{td0\+\_\+compressed}} (int flag)
\begin{DoxyCompactList}\small\item\em Enable Tele\+Disk image compression mode. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a3f65dd34ac6cf2ee2ab6d5a913b0e457}{td0\+\_\+read}} (void $\ast$p, int osize, int size, \mbox{\hyperlink{posix_8h_aed4dabeb9f7c518ded42f930a04abce8}{F\+I\+LE}} $\ast$fp)
\begin{DoxyCompactList}\small\item\em Read Tele\+Disk image data block Optionally decompress the data if decompression is enabled. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a7f9b8f09a74778aafcef0ccfcf7e73e6}{td0\+\_\+rle}} (uint8\+\_\+t $\ast$\mbox{\hyperlink{time_8c_a5a388b2bb2a2a9914c7d68ed3d09f7e9}{dst}}, uint8\+\_\+t $\ast$src, int max)
\begin{DoxyCompactList}\small\item\em Expand a Run Length encoded Tele\+Disk sector Notes\+: the source length is encoded in the source data Credits based on work (C) 2006-\/2014 Jean-\/\+François D\+EL N\+E\+RO Part of the Hx\+C\+Floppy\+Emulator library G\+NU G\+PL version 2 or later Rewitten for clarity,to enforce size limits, provide error reporting and to avoid word order dependent assumptions,. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{td02lif_8c_ab14f2a074ca85e1b32cc26f3369c574f}{td0\+\_\+trackinfo}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}}, int trackind, int index)
\begin{DoxyCompactList}\small\item\em Display Tele\+Disk track sector values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{td02lif_8c_aff9adf4831cee8528e02b6456459435e}{td0\+\_\+sectorinfo}} (\mbox{\hyperlink{structtd__sector__t}{td\+\_\+sector\+\_\+t}} $\ast$P)
\begin{DoxyCompactList}\small\item\em Display Tele\+Disk sector data. \end{DoxyCompactList}\item 
long \mbox{\hyperlink{td02lif_8c_a48825de35a808127b9c304a764a48439}{td0\+\_\+density2bitrate}} (uint8\+\_\+t density)
\begin{DoxyCompactList}\small\item\em Convert Denisity to bitrate @\+We don\textquotesingle{}t care about the density except as a possible filter. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_ab49e4bf7cf89d5c6b90181a6bac46de6}{td0\+\_\+open}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}}, char $\ast$name)
\begin{DoxyCompactList}\small\item\em Opne Tele\+Disk image file process header and optional comment block. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a87120823fa3dd587214e6c70ebde151f}{td0\+\_\+read\+\_\+disk}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}})
\begin{DoxyCompactList}\small\item\em Read Tele\+Disk image file and save all sector data. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_ac777daf6e56deb920d24ac72f83f0624}{td0\+\_\+analize\+\_\+format}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}})
\begin{DoxyCompactList}\small\item\em Analize Tele\+Disk disk sector data Problem\+: We may have a disk that was reformatted multiple times Each format may have used differing sector sizes, number of tracks, sides For example\+: First format 80 track disk, two sided, and 9 512 byte sectors per track Second format 35 tracks, single sided, 16 sectors 256 bytes size per track Clearly we only want the 35 tracks on the first side. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a2b045f601a00f806f99e466e18109a08}{td0\+\_\+save\+\_\+lif}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}}, \mbox{\hyperlink{structlif__t}{lif\+\_\+t}} $\ast$L\+IF)
\begin{DoxyCompactList}\small\item\em save remaining sectors as L\+IF data \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a08cbf8c12076d3677df348da2dbf7ca2}{td0\+\_\+save\+\_\+lif\+\_\+sector}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}}, uint8\+\_\+t $\ast$data, int size, \mbox{\hyperlink{structlif__t}{lif\+\_\+t}} $\ast$L\+IF)
\begin{DoxyCompactList}\small\item\em Process all sectors on a track from Tele\+Disk image. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{td02lif_8c_a26d4f0afc5df75f388d93a9510ab39ee}{td0\+\_\+help}} (int full)
\item 
void \mbox{\hyperlink{td02lif_8c_af8f1231cf42003200a45f8b6828f13c1}{td0\+\_\+init\+\_\+liftel}} ()
\begin{DoxyCompactList}\small\item\em Tele\+Disk image Analisis structure Find attributes of L\+IF image stored in Tele\+Disk image. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{td02lif_8c_a250c5e050c7c158c05611ba8dbf985a9}{td0\+\_\+init\+\_\+sectors}} (\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$\mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}})
\begin{DoxyCompactList}\small\item\em Initialize track sector information Optionally decompress the data if decompression is enabled. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{td02lif_8c_a768caca68199c490335ee088781e7bba}{td02lif}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Convert a Teledisk L\+IF formatted disk image into a pure L\+IF image. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} \mbox{\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}}
\begin{DoxyCompactList}\small\item\em Dave Dunfiled L\+Z\+SS expander. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structliftel__t}{liftel\+\_\+t}} \mbox{\hyperlink{td02lif_8c_af2b2b3e4827acc662c88bb762e41106d}{liftel}}
\begin{DoxyCompactList}\small\item\em Teledisk liftel analysis and user overrides. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Tele\+Disk decoder library targetting L\+IF format images only. 

\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, Inc. All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
\href{http://github.com/magore/hp85disk}{\texttt{ http\+://github.\+com/magore/hp85disk}} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\texttt{ http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md}} for Copyright details
\end{DoxySeeAlso}
@help L\+IF command help lif td02lif image.\+td0 image.\+lif Convert Tele\+Disk encoded L\+IF disk image into to pure L\+IF image T\+E\+L\+E\+D\+I\+SK command help td02lif file.\+td0 file.\+lif Convert Tele\+Disk encoded L\+IF disk image into to pure L\+IF image

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
@\+Credits lif/teledisk My T\+E\+L\+E\+D\+I\+SK L\+IF extracter Note\+: The Tele\+Disk image M\+U\+ST contain a L\+IF image -\/ we do N\+OT translate it R\+E\+A\+D\+M\+E.\+txt Credits Important Contributions (My converted would not have been possible without these) Dave Dunfield, L\+Z\+SS Code and Tele\+Disk documentation Copyright 2007-\/2008 Dave Dunfield All rights reserved. td0\+\_\+lzss.\+h td0\+\_\+lzss.\+c L\+Z\+SS decoder td0notes.\+txt Teledisk Documentation Jean-\/\+Franois D\+EL N\+E\+RO, Tele\+Disk Documentation Copyright (C) 2006-\/2014 Jean-\/\+Franois D\+EL N\+E\+RO wteledsk.\+htm Tele\+Disk documenation See his github project \href{https://github.com/jfdelnero/libhxcfe}{\texttt{ https\+://github.\+com/jfdelnero/libhxcfe}} 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{td02lif_8c_a768caca68199c490335ee088781e7bba}\label{td02lif_8c_a768caca68199c490335ee088781e7bba}} 
\index{td02lif.c@{td02lif.c}!td02lif@{td02lif}}
\index{td02lif@{td02lif}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td02lif()}{td02lif()}}
{\footnotesize\ttfamily int td02lif (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Convert a Teledisk L\+IF formatted disk image into a pure L\+IF image. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em telediskname} & T\+E\+L\+E\+D\+I\+SK image name \\
\hline
\mbox{\texttt{ in}}  & {\em lifname} & L\+IF file name to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, 0 on error 
\end{DoxyReturn}
Write L\+IF file

L\+IF summary

Close L\+IF file

Definition at line 1650 of file td02lif.\+c.



Referenced by lif\+\_\+tests().

\mbox{\Hypertarget{td02lif_8c_ac777daf6e56deb920d24ac72f83f0624}\label{td02lif_8c_ac777daf6e56deb920d24ac72f83f0624}} 
\index{td02lif.c@{td02lif.c}!td0\_analize\_format@{td0\_analize\_format}}
\index{td0\_analize\_format@{td0\_analize\_format}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_analize\_format()}{td0\_analize\_format()}}
{\footnotesize\ttfamily int td0\+\_\+analize\+\_\+format (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk }\end{DoxyParamCaption})}



Analize Tele\+Disk disk sector data Problem\+: We may have a disk that was reformatted multiple times Each format may have used differing sector sizes, number of tracks, sides For example\+: First format 80 track disk, two sided, and 9 512 byte sectors per track Second format 35 tracks, single sided, 16 sectors 256 bytes size per track Clearly we only want the 35 tracks on the first side. 

What we do is examine the first 30 tracks (note\+: 30 is just a safe number less then 35) On side 1, on 30 tracks Find first sector and save its size Reject sectors that do not match size Find Last sector matching size Count sectors matching size On side 2, on 30 tracks Reject sectors that do not match size Find first sector and save its size Find Last sector matching size Count sectors matching size

If the disk had two sides recorded in the header Reject second side if side sector counts do N\+OT match Reject second side if NO remaining sectors Reject second side if sector ranges do not match or continue in range


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em dist} & T\+D0 image data @retrun 1 if OK, 0 on error \\
\hline
\end{DoxyParams}


Definition at line 896 of file td02lif.\+c.



Referenced by td02lif().

\mbox{\Hypertarget{td02lif_8c_a369d6a9b15ee337cfb9e998b3e914f9c}\label{td02lif_8c_a369d6a9b15ee337cfb9e998b3e914f9c}} 
\index{td02lif.c@{td02lif.c}!td0\_B2S@{td0\_B2S}}
\index{td0\_B2S@{td0\_B2S}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_B2S()}{td0\_B2S()}}
{\footnotesize\ttfamily void td0\+\_\+\+B2S (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{B,  }\item[{int}]{index,  }\item[{uint8\+\_\+t $\ast$}]{name,  }\item[{int}]{size }\end{DoxyParamCaption})}



Create a string from data that has no E\+OS but known size. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em $\ast$B} & source \\
\hline
\mbox{\texttt{ in}}  & {\em index} & index offset into source data \\
\hline
\mbox{\texttt{ out}}  & {\em $\ast$name} & target string \\
\hline
\mbox{\texttt{ in}}  & {\em size} & size of string to write -\/ not including E\+OS \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 68 of file td02lif.\+c.



Referenced by td0\+\_\+unpack\+\_\+disk\+\_\+header().

\mbox{\Hypertarget{td02lif_8c_a786b280e1ac85ba19bcb2f4ca0d21ee3}\label{td02lif_8c_a786b280e1ac85ba19bcb2f4ca0d21ee3}} 
\index{td02lif.c@{td02lif.c}!td0\_compressed@{td0\_compressed}}
\index{td0\_compressed@{td0\_compressed}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_compressed()}{td0\_compressed()}}
{\footnotesize\ttfamily void td0\+\_\+compressed (\begin{DoxyParamCaption}\item[{int}]{flag }\end{DoxyParamCaption})}



Enable Tele\+Disk image compression mode. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em flag} & compression anable/disable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 250 of file td02lif.\+c.



Referenced by td0\+\_\+open().

\mbox{\Hypertarget{td02lif_8c_a1e9e20346b224655b6586eb34efe1b5f}\label{td02lif_8c_a1e9e20346b224655b6586eb34efe1b5f}} 
\index{td02lif.c@{td02lif.c}!td0\_crc16@{td0\_crc16}}
\index{td0\_crc16@{td0\_crc16}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_crc16()}{td0\_crc16()}}
{\footnotesize\ttfamily uint16\+\_\+t td0\+\_\+crc16 (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{B,  }\item[{uint16\+\_\+t}]{crc,  }\item[{uint16\+\_\+t}]{poly,  }\item[{int}]{size }\end{DoxyParamCaption})}



Compute C\+R\+C16 of 8bit data. 

\begin{DoxySeeAlso}{See also}
\href{https://en.wikipedia.org/wiki/Cyclic_redundancy_check}{\texttt{ https\+://en.\+wikipedia.\+org/wiki/\+Cyclic\+\_\+redundancy\+\_\+check}} F\+YI normal C\+R\+C16 typically use 0x1021 for ploy Note\+: You can do a C\+R\+C16 of data in blocks by passing the result as the crc initial value for the next call 
\end{DoxySeeAlso}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em $\ast$B} & 8 bit binary data \\
\hline
\mbox{\texttt{ in}}  & {\em crc} & initial crc value \\
\hline
\mbox{\texttt{ out}}  & {\em poly} & ploynomial \\
\hline
\mbox{\texttt{ in}}  & {\em size} & number of bytes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
crc16 of result 
\end{DoxyReturn}


Definition at line 87 of file td02lif.\+c.



Referenced by td0\+\_\+open(), td0\+\_\+read\+\_\+disk(), td0\+\_\+unpack\+\_\+comment\+\_\+header(), td0\+\_\+unpack\+\_\+disk\+\_\+header(), and td0\+\_\+unpack\+\_\+track\+\_\+header().

\mbox{\Hypertarget{td02lif_8c_a48825de35a808127b9c304a764a48439}\label{td02lif_8c_a48825de35a808127b9c304a764a48439}} 
\index{td02lif.c@{td02lif.c}!td0\_density2bitrate@{td0\_density2bitrate}}
\index{td0\_density2bitrate@{td0\_density2bitrate}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_density2bitrate()}{td0\_density2bitrate()}}
{\footnotesize\ttfamily long td0\+\_\+density2bitrate (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{density }\end{DoxyParamCaption})}



Convert Denisity to bitrate @\+We don\textquotesingle{}t care about the density except as a possible filter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em Density} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bitrate 
\end{DoxyReturn}


Definition at line 472 of file td02lif.\+c.

\mbox{\Hypertarget{td02lif_8c_a26d4f0afc5df75f388d93a9510ab39ee}\label{td02lif_8c_a26d4f0afc5df75f388d93a9510ab39ee}} 
\index{td02lif.c@{td02lif.c}!td0\_help@{td0\_help}}
\index{td0\_help@{td0\_help}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_help()}{td0\_help()}}
{\footnotesize\ttfamily void td0\+\_\+help (\begin{DoxyParamCaption}\item[{int}]{full }\end{DoxyParamCaption})}



Definition at line 1556 of file td02lif.\+c.



Referenced by help(), lif\+\_\+tests(), and td02lif().

\mbox{\Hypertarget{td02lif_8c_a4d01fdafef7fb089054149fd0c04c75f}\label{td02lif_8c_a4d01fdafef7fb089054149fd0c04c75f}} 
\index{td02lif.c@{td02lif.c}!td0\_hexdump@{td0\_hexdump}}
\index{td0\_hexdump@{td0\_hexdump}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_hexdump()}{td0\_hexdump()}}
{\footnotesize\ttfamily void td0\+\_\+hexdump (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{size }\end{DoxyParamCaption})}



hex listing of data 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em $\ast$data} & date to dump \\
\hline
\mbox{\texttt{ in}}  & {\em size} & size of data to dump @retrun void \\
\hline
\end{DoxyParams}


Definition at line 110 of file td02lif.\+c.



Referenced by td0\+\_\+save\+\_\+lif\+\_\+sector().

\mbox{\Hypertarget{td02lif_8c_af8f1231cf42003200a45f8b6828f13c1}\label{td02lif_8c_af8f1231cf42003200a45f8b6828f13c1}} 
\index{td02lif.c@{td02lif.c}!td0\_init\_liftel@{td0\_init\_liftel}}
\index{td0\_init\_liftel@{td0\_init\_liftel}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_init\_liftel()}{td0\_init\_liftel()}}
{\footnotesize\ttfamily void td0\+\_\+init\+\_\+liftel (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Tele\+Disk image Analisis structure Find attributes of L\+IF image stored in Tele\+Disk image. 



Definition at line 1577 of file td02lif.\+c.



Referenced by td02lif().

\mbox{\Hypertarget{td02lif_8c_a250c5e050c7c158c05611ba8dbf985a9}\label{td02lif_8c_a250c5e050c7c158c05611ba8dbf985a9}} 
\index{td02lif.c@{td02lif.c}!td0\_init\_sectors@{td0\_init\_sectors}}
\index{td0\_init\_sectors@{td0\_init\_sectors}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_init\_sectors()}{td0\_init\_sectors()}}
{\footnotesize\ttfamily void td0\+\_\+init\+\_\+sectors (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk }\end{DoxyParamCaption})}



Initialize track sector information Optionally decompress the data if decompression is enabled. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em p} & data buffer for read \\
\hline
\mbox{\texttt{ out}}  & {\em osize} & size of object \\
\hline
\mbox{\texttt{ out}}  & {\em size} & number of objects to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size of dataactually read 
\end{DoxyReturn}


Definition at line 1614 of file td02lif.\+c.



Referenced by td02lif().

\mbox{\Hypertarget{td02lif_8c_ab49e4bf7cf89d5c6b90181a6bac46de6}\label{td02lif_8c_ab49e4bf7cf89d5c6b90181a6bac46de6}} 
\index{td02lif.c@{td02lif.c}!td0\_open@{td0\_open}}
\index{td0\_open@{td0\_open}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_open()}{td0\_open()}}
{\footnotesize\ttfamily int td0\+\_\+open (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk,  }\item[{char $\ast$}]{name }\end{DoxyParamCaption})}



Opne Tele\+Disk image file process header and optional comment block. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em $\ast$disk} & Tele\+Disk information structure \\
\hline
\mbox{\texttt{ in}}  & {\em $\ast$name} & image file name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success 0 on error Note\+: on success disk-\/$>$fi has the file handle disk-\/$>$td0\+\_\+name has the file name disk-\/$>$compresssed if image is compressed disk-\/$>$td\+\_\+header has teledisk header disk-\/$>$td\+\_\+comment has optional teledisk comment header or zeroed If disk.\+td\+\_\+comment.\+Size $>$ 0 disk-\/$>$comment has optional comment string or empty string If disk.\+td\+\_\+comment.\+Size $>$ 0 
\end{DoxyReturn}
@process Tele\+Disk disk image header

we expect \char`\"{}\+T\+D\char`\"{} (uncompressed) or \char`\"{}td\char`\"{} (compressed) format

We only accept Tele\+Disk versions $>$= 10 \&\& version $<$= 21

Time to Unix format

Definition at line 506 of file td02lif.\+c.



Referenced by td02lif().

\mbox{\Hypertarget{td02lif_8c_a3f65dd34ac6cf2ee2ab6d5a913b0e457}\label{td02lif_8c_a3f65dd34ac6cf2ee2ab6d5a913b0e457}} 
\index{td02lif.c@{td02lif.c}!td0\_read@{td0\_read}}
\index{td0\_read@{td0\_read}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_read()}{td0\_read()}}
{\footnotesize\ttfamily int td0\+\_\+read (\begin{DoxyParamCaption}\item[{void $\ast$}]{p,  }\item[{int}]{osize,  }\item[{int}]{size,  }\item[{\mbox{\hyperlink{posix_8h_aed4dabeb9f7c518ded42f930a04abce8}{F\+I\+LE}} $\ast$}]{fp }\end{DoxyParamCaption})}



Read Tele\+Disk image data block Optionally decompress the data if decompression is enabled. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em p} & data buffer for read \\
\hline
\mbox{\texttt{ out}}  & {\em osize} & size of object \\
\hline
\mbox{\texttt{ out}}  & {\em size} & number of objects to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success all bytes read, 0 on failure not all bytes read 
\end{DoxyReturn}


Definition at line 264 of file td02lif.\+c.



Referenced by td0\+\_\+open(), and td0\+\_\+read\+\_\+disk().

\mbox{\Hypertarget{td02lif_8c_a87120823fa3dd587214e6c70ebde151f}\label{td02lif_8c_a87120823fa3dd587214e6c70ebde151f}} 
\index{td02lif.c@{td02lif.c}!td0\_read\_disk@{td0\_read\_disk}}
\index{td0\_read\_disk@{td0\_read\_disk}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_read\_disk()}{td0\_read\_disk()}}
{\footnotesize\ttfamily int td0\+\_\+read\+\_\+disk (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk }\end{DoxyParamCaption})}



Read Tele\+Disk image file and save all sector data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em dist} & T\+D0 image data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success 0 on error 
\end{DoxyReturn}
Process all image Data

E\+OF? Tele\+Disk specification says E\+OF is 255 sectors

Process all track sectors

Sector Header

first test verifies sector $<$ 2K in size second test verifies no data or address mark errors

Compute how much data to read

td0\+\_\+rle does not use len internal data in the buffer does this We limit the expansion to sector size

=========================================

Definition at line 643 of file td02lif.\+c.



Referenced by td02lif().

\mbox{\Hypertarget{td02lif_8c_a7f9b8f09a74778aafcef0ccfcf7e73e6}\label{td02lif_8c_a7f9b8f09a74778aafcef0ccfcf7e73e6}} 
\index{td02lif.c@{td02lif.c}!td0\_rle@{td0\_rle}}
\index{td0\_rle@{td0\_rle}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_rle()}{td0\_rle()}}
{\footnotesize\ttfamily int td0\+\_\+rle (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{dst,  }\item[{uint8\+\_\+t $\ast$}]{src,  }\item[{int}]{max }\end{DoxyParamCaption})}



Expand a Run Length encoded Tele\+Disk sector Notes\+: the source length is encoded in the source data Credits based on work (C) 2006-\/2014 Jean-\/\+François D\+EL N\+E\+RO Part of the Hx\+C\+Floppy\+Emulator library G\+NU G\+PL version 2 or later Rewitten for clarity,to enforce size limits, provide error reporting and to avoid word order dependent assumptions,. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em dst} & destination expanded data \\
\hline
\mbox{\texttt{ in}}  & {\em src} & source data \\
\hline
\mbox{\texttt{ in}}  & {\em max} & maximum size of destination data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size of expanded data, negative if size $>$ max 
\end{DoxyReturn}
@actual length

block size

repeat count

Definition at line 307 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().

\mbox{\Hypertarget{td02lif_8c_a2b045f601a00f806f99e466e18109a08}\label{td02lif_8c_a2b045f601a00f806f99e466e18109a08}} 
\index{td02lif.c@{td02lif.c}!td0\_save\_lif@{td0\_save\_lif}}
\index{td0\_save\_lif@{td0\_save\_lif}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_save\_lif()}{td0\_save\_lif()}}
{\footnotesize\ttfamily int td0\+\_\+save\+\_\+lif (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk,  }\item[{\mbox{\hyperlink{structlif__t}{lif\+\_\+t}} $\ast$}]{L\+IF }\end{DoxyParamCaption})}



save remaining sectors as L\+IF data 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em data} & sector data \\
\hline
\mbox{\texttt{ in}}  & {\em L\+IF} & L\+IF structure @retrun 1 if OK, 0 on error \\
\hline
\end{DoxyParams}


Definition at line 1303 of file td02lif.\+c.



Referenced by td02lif().

\mbox{\Hypertarget{td02lif_8c_a08cbf8c12076d3677df348da2dbf7ca2}\label{td02lif_8c_a08cbf8c12076d3677df348da2dbf7ca2}} 
\index{td02lif.c@{td02lif.c}!td0\_save\_lif\_sector@{td0\_save\_lif\_sector}}
\index{td0\_save\_lif\_sector@{td0\_save\_lif\_sector}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_save\_lif\_sector()}{td0\_save\_lif\_sector()}}
{\footnotesize\ttfamily int td0\+\_\+save\+\_\+lif\+\_\+sector (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk,  }\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{size,  }\item[{\mbox{\hyperlink{structlif__t}{lif\+\_\+t}} $\ast$}]{L\+IF }\end{DoxyParamCaption})}



Process all sectors on a track from Tele\+Disk image. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em data} & sector data \\
\hline
\mbox{\texttt{ in}}  & {\em size} & sector size \\
\hline
\mbox{\texttt{ in}}  & {\em L\+IF} & L\+IF structure @retrun 1 if OK, 0 on error \\
\hline
\end{DoxyParams}
==================================================== Write sectors from Teledisk track to L\+IF file \hypertarget{td02lif.c_autotoc_md187}{}\doxysubsection{We continue until the last last file sector}\label{td02lif.c_autotoc_md187}


Definition at line 1366 of file td02lif.\+c.



Referenced by td0\+\_\+save\+\_\+lif().

\mbox{\Hypertarget{td02lif_8c_aff9adf4831cee8528e02b6456459435e}\label{td02lif_8c_aff9adf4831cee8528e02b6456459435e}} 
\index{td02lif.c@{td02lif.c}!td0\_sectorinfo@{td0\_sectorinfo}}
\index{td0\_sectorinfo@{td0\_sectorinfo}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_sectorinfo()}{td0\_sectorinfo()}}
{\footnotesize\ttfamily void td0\+\_\+sectorinfo (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structtd__sector__t}{td\+\_\+sector\+\_\+t}} $\ast$}]{P }\end{DoxyParamCaption})}



Display Tele\+Disk sector data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em P} & td\+\_\+sector pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 458 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().

\mbox{\Hypertarget{td02lif_8c_ab14f2a074ca85e1b32cc26f3369c574f}\label{td02lif_8c_ab14f2a074ca85e1b32cc26f3369c574f}} 
\index{td02lif.c@{td02lif.c}!td0\_trackinfo@{td0\_trackinfo}}
\index{td0\_trackinfo@{td0\_trackinfo}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_trackinfo()}{td0\_trackinfo()}}
{\footnotesize\ttfamily void td0\+\_\+trackinfo (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} $\ast$}]{disk,  }\item[{int}]{trackind,  }\item[{int}]{index }\end{DoxyParamCaption})}



Display Tele\+Disk track sector values. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em sector} & track sector structure \\
\hline
\mbox{\texttt{ in}}  & {\em index} & sector index (not sector number) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 443 of file td02lif.\+c.



Referenced by td0\+\_\+analize\+\_\+format(), and td0\+\_\+read\+\_\+disk().

\mbox{\Hypertarget{td02lif_8c_aa2721b8d8bba4008a2b48d1b362b9850}\label{td02lif_8c_aa2721b8d8bba4008a2b48d1b362b9850}} 
\index{td02lif.c@{td02lif.c}!td0\_unpack\_comment\_header@{td0\_unpack\_comment\_header}}
\index{td0\_unpack\_comment\_header@{td0\_unpack\_comment\_header}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_unpack\_comment\_header()}{td0\_unpack\_comment\_header()}}
{\footnotesize\ttfamily int td0\+\_\+unpack\+\_\+comment\+\_\+header (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{B,  }\item[{\mbox{\hyperlink{structtd__comment__t}{td\+\_\+comment\+\_\+t}} $\ast$}]{p }\end{DoxyParamCaption})}



Extract Tele\+Disk comment header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em B} & source data \\
\hline
\mbox{\texttt{ out}}  & {\em p} & Tele\+Disk comment header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk comment header size (not structure size) 
\end{DoxyReturn}


Definition at line 178 of file td02lif.\+c.



Referenced by td0\+\_\+open().

\mbox{\Hypertarget{td02lif_8c_a038d4e9f86f76569a97e443e376a8e11}\label{td02lif_8c_a038d4e9f86f76569a97e443e376a8e11}} 
\index{td02lif.c@{td02lif.c}!td0\_unpack\_disk\_header@{td0\_unpack\_disk\_header}}
\index{td0\_unpack\_disk\_header@{td0\_unpack\_disk\_header}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_unpack\_disk\_header()}{td0\_unpack\_disk\_header()}}
{\footnotesize\ttfamily int td0\+\_\+unpack\+\_\+disk\+\_\+header (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{B,  }\item[{\mbox{\hyperlink{structtd__header__t}{td\+\_\+header\+\_\+t}} $\ast$}]{p }\end{DoxyParamCaption})}



Extract Tele\+Disk image header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em B} & source data \\
\hline
\mbox{\texttt{ out}}  & {\em p} & Tele\+Disk image header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk image header size (not structure size) 
\end{DoxyReturn}


Definition at line 151 of file td02lif.\+c.



Referenced by td0\+\_\+open().

\mbox{\Hypertarget{td02lif_8c_ac393151af482d511b246de534da58e6f}\label{td02lif_8c_ac393151af482d511b246de534da58e6f}} 
\index{td02lif.c@{td02lif.c}!td0\_unpack\_sector\_header@{td0\_unpack\_sector\_header}}
\index{td0\_unpack\_sector\_header@{td0\_unpack\_sector\_header}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_unpack\_sector\_header()}{td0\_unpack\_sector\_header()}}
{\footnotesize\ttfamily int td0\+\_\+unpack\+\_\+sector\+\_\+header (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{B,  }\item[{\mbox{\hyperlink{structtd__sector__t}{td\+\_\+sector\+\_\+t}} $\ast$}]{p }\end{DoxyParamCaption})}



Extract Tele\+Disk sector header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em B} & source data \\
\hline
\mbox{\texttt{ out}}  & {\em p} & Tele\+Disk sector header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk sector header size (not structure size) 
\end{DoxyReturn}


Definition at line 232 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().

\mbox{\Hypertarget{td02lif_8c_ab9cc29346498d37ff85d3a3417d8fc11}\label{td02lif_8c_ab9cc29346498d37ff85d3a3417d8fc11}} 
\index{td02lif.c@{td02lif.c}!td0\_unpack\_track\_header@{td0\_unpack\_track\_header}}
\index{td0\_unpack\_track\_header@{td0\_unpack\_track\_header}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{td0\_unpack\_track\_header()}{td0\_unpack\_track\_header()}}
{\footnotesize\ttfamily int td0\+\_\+unpack\+\_\+track\+\_\+header (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{B,  }\item[{\mbox{\hyperlink{structtd__track__t}{td\+\_\+track\+\_\+t}} $\ast$}]{p }\end{DoxyParamCaption})}



Extract Tele\+Disk track header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em B} & source data \\
\hline
\mbox{\texttt{ out}}  & {\em p} & Tele\+Disk track header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk track header size (not structure size) 
\end{DoxyReturn}


Definition at line 201 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{td02lif_8c_affcceda12b139f26819f4929be705eb1}\label{td02lif_8c_affcceda12b139f26819f4929be705eb1}} 
\index{td02lif.c@{td02lif.c}!disk@{disk}}
\index{disk@{disk}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{disk}{disk}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdisk__t}{disk\+\_\+t}} disk}



Dave Dunfiled L\+Z\+SS expander. 



Definition at line 57 of file td02lif.\+c.



Referenced by td02lif(), td0\+\_\+analize\+\_\+format(), td0\+\_\+compressed(), td0\+\_\+init\+\_\+sectors(), td0\+\_\+open(), td0\+\_\+read(), td0\+\_\+read\+\_\+disk(), td0\+\_\+save\+\_\+lif(), and td0\+\_\+trackinfo().

\mbox{\Hypertarget{td02lif_8c_af2b2b3e4827acc662c88bb762e41106d}\label{td02lif_8c_af2b2b3e4827acc662c88bb762e41106d}} 
\index{td02lif.c@{td02lif.c}!liftel@{liftel}}
\index{liftel@{liftel}!td02lif.c@{td02lif.c}}
\doxysubsubsection{\texorpdfstring{liftel}{liftel}}
{\footnotesize\ttfamily \mbox{\hyperlink{structliftel__t}{liftel\+\_\+t}} liftel}



Teledisk liftel analysis and user overrides. 



Definition at line 60 of file td02lif.\+c.



Referenced by td02lif(), td0\+\_\+analize\+\_\+format(), td0\+\_\+init\+\_\+liftel(), td0\+\_\+save\+\_\+lif(), and td0\+\_\+save\+\_\+lif\+\_\+sector().

